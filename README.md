# Monorepo Nuxt 4 é¡¹ç›®

è¿™æ˜¯ä¸€ä¸ªåŸºäº Nuxt 4 çš„é«˜åº¦å·¥ç¨‹åŒ–çš„ Monorepo é¡¹ç›®ï¼Œä½¿ç”¨ pnpm workspaces å’Œ Turborepo è¿›è¡Œç®¡ç†ã€‚é¡¹ç›®é‡‡ç”¨ **Nuxt Layers** æ¶æ„ï¼Œå®ç°äº†ä»£ç çš„é«˜åº¦å¤ç”¨å’Œåº”ç”¨é—´çš„è§£è€¦ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: [Nuxt 4](https://nuxt.com/)
- **åŒ…ç®¡ç†**: [pnpm](https://pnpm.io/)
- **ä»»åŠ¡ç®¡ç†**: [Turborepo](https://turbo.build/)
- **æ ·å¼**: [Tailwind CSS](https://tailwindcss.com/)
- **çŠ¶æ€ç®¡ç†**: [Pinia](https://pinia.vuejs.org/)
- **è¯­è¨€**: [TypeScript](https://www.typescriptlang.org/)

## ğŸ“ ç›®å½•è¯´æ˜

```text
.
â”œâ”€â”€ apps/                   # åº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ web/                # åº”ç”¨ 1 (Nuxt 4)
â”‚   â””â”€â”€ web1/               # åº”ç”¨ 2 (Nuxt 4)
â”œâ”€â”€ packages/               # å…±äº«åŒ…ç›®å½•
â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒé€»è¾‘å±‚ (Nuxt Layer)
â”‚   â”‚   â”œâ”€â”€ modules/        # å…±äº« Nuxt æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ plugins/        # å…±äº«æ’ä»¶
â”‚   â”‚   â”œâ”€â”€ server/         # å…±äº«æœåŠ¡å™¨ä¸­é—´ä»¶/è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ stores/         # å…±äº« Pinia ä»“åº“
â”‚   â”‚   â””â”€â”€ i18n/           # å›½é™…åŒ–æ ¸å¿ƒé…ç½®
â”‚   â”œâ”€â”€ ui/                 # UI ç»„ä»¶å±‚ (Nuxt Layer)
â”‚   â”‚   â”œâ”€â”€ layouts/        # å…±äº«å¸ƒå±€
â”‚   â”‚   â””â”€â”€ components/     # (è®¡åˆ’ä¸­) å…±äº« UI ç»„ä»¶
â”‚   â””â”€â”€ utils/              # å·¥å…·åº“ (Pure TypeScript)
â”‚       â”œâ”€â”€ src/            # é€šç”¨å·¥å…·å‡½æ•°
â”‚       â””â”€â”€ types/          # å…¨å±€ç±»å‹å®šä¹‰
â”œâ”€â”€ package.json            # æ ¹é¡¹ç›®é…ç½®
â”œâ”€â”€ pnpm-workspace.yaml     # pnpm å·¥ä½œåŒºé…ç½®
â”œâ”€â”€ turbo.json              # Turborepo ä»»åŠ¡æµé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¼€å‘èŒƒå¼ (Development Paradigm)

### 1. åˆ†å±‚æ¶æ„ (Layered Architecture)
æœ¬é¡¹ç›®é‡‡ç”¨æ¸…æ™°çš„ä¸‰å±‚æ¶æ„è®¾è®¡ï¼Œå®ç°äº†å…³æ³¨ç‚¹åˆ†ç¦»ï¼š

- **Utils å±‚ (`packages/utils`)**: æœ€åº•å±‚çš„çº¯ TypeScript åº“ï¼Œä¸ä¾èµ– Vue/Nuxtã€‚æä¾›é€šç”¨çš„å·¥å…·å‡½æ•°å’Œç±»å‹å®šä¹‰ã€‚
- **Core å±‚ (`packages/core`)**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚ (Nuxt Layer)ã€‚åŒ…å«çŠ¶æ€ç®¡ç† (Pinia)ã€æ’ä»¶ã€æœåŠ¡ç«¯ä¸­é—´ä»¶ã€æ¨¡å—é…ç½® (Base Module) å’Œ i18n åŸºç¡€é…ç½®ã€‚
- **UI å±‚ (`packages/ui`)**: è§†è§‰è¡¨ç°å±‚ (Nuxt Layer)ã€‚ç»§æ‰¿è‡ª Core å±‚ï¼Œæä¾›å¸ƒå±€ (Layouts)ã€UI ç»„ä»¶å’Œæ ·å¼é…ç½®ã€‚
- **åº”ç”¨å±‚ (`apps/*`)**: å…·ä½“çš„ä¸šåŠ¡åº”ç”¨ã€‚ç»§æ‰¿è‡ª UI å±‚ï¼Œåªéœ€å…³æ³¨è¯¥åº”ç”¨ç‰¹æœ‰çš„é¡µé¢å’Œé€»è¾‘ã€‚

### 2. Nuxt Layers ç»§æ‰¿æœºåˆ¶
é€šè¿‡ Nuxt 4 çš„ `extends` ç‰¹æ€§å®ç°å±‚çº§ç»§æ‰¿ï¼š
`App` -> `UI Layer` -> `Core Layer`

- **è‡ªåŠ¨æ¨¡å—æ³¨å…¥**: `packages/core/modules/base.ts` ä¼šè‡ªåŠ¨ä¸ºæ‰€æœ‰åº”ç”¨æ³¨å…¥æ ¸å¿ƒä¾èµ–ï¼ˆPinia, Tailwind CSS, Element Plus, VueUseï¼‰ã€‚
- **é…ç½®ç»§æ‰¿**: å­åº”ç”¨è‡ªåŠ¨ç»§æ‰¿ä¸Šå±‚é…ç½®ï¼Œå¹¶å¯åœ¨ `nuxt.config.ts` ä¸­è¿›è¡Œè¦†ç›–ã€‚

### 3. ä»£ç å…±äº«ç­–ç•¥
- **å·¥å…·/ç±»å‹**: æ”¾åœ¨ `packages/utils`ï¼Œé€šè¿‡ `@repo/utils` å¼•å…¥ã€‚
- **ä¸šåŠ¡é€»è¾‘**: é€šç”¨ Storeã€Pluginsã€Server Middleware æ”¾åœ¨ `packages/core`ã€‚
- **UI/å¸ƒå±€**: é€šç”¨ Layouts å’Œ Components æ”¾åœ¨ `packages/ui`ã€‚
- **æ ·å¼å¼€å‘**: `packages/ui` å’Œ `packages/core` ä¸­çš„ç»„ä»¶å®Œå…¨æ”¯æŒ Tailwind CSSã€‚

### 4. å›½é™…åŒ– (i18n) ç­–ç•¥
- **é€šç”¨é…ç½®**: è·¯ç”±ç­–ç•¥ï¼ˆ`strategy`ï¼‰ã€é»˜è®¤è¯­è¨€ç­‰æ ¸å¿ƒé…ç½®ç»Ÿä¸€åœ¨ `packages/core` ä¸­ç®¡ç†ã€‚
- **è¯­è¨€åŒ…**: å„ä¸ªåº”ç”¨åªéœ€åœ¨ `nuxt.config.ts` ä¸­å®šä¹‰è‡ªå·±çš„ `locales` åˆ—è¡¨å’Œè¯­è¨€æ–‡ä»¶è·¯å¾„ã€‚

### 5. åˆ«åçº¦å®š
- `@` æˆ– `~`: æŒ‡å‘**å½“å‰åº”ç”¨**çš„æ ¹ç›®å½•ã€‚
- `~~`: æŒ‡å‘æ•´ä¸ª **Monorepo** çš„æ ¹ç›®å½•ã€‚
- `@repo/utils`: å¼•ç”¨å·¥å…·åŒ…ã€‚

## âŒ¨ï¸ å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
| :--- | :--- |
| `pnpm install` | å®‰è£…æ‰€æœ‰ä¾èµ– |
| `pnpm dev` | å¯åŠ¨æ‰€æœ‰åº”ç”¨çš„å¼€å‘æœåŠ¡å™¨ |
| `pnpm build` | æ„å»ºæ‰€æœ‰åº”ç”¨ |
| `pnpm lint` | è¿è¡Œ lint æ£€æŸ¥ |

## âš ï¸ æ³¨æ„äº‹é¡¹

1.  **ä¾èµ–å®‰è£…**: è¯·åŠ¡å¿…åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œ `pnpm install`ã€‚è‹¥éœ€ç»™ç‰¹å®šåº”ç”¨å®‰è£…ä¾èµ–ï¼Œå»ºè®®ä½¿ç”¨ `pnpm add <pkg> --filter <app-name>`ã€‚
2.  **Layer å¼€å‘**: ä¿®æ”¹ `packages/core` æˆ– `packages/ui` æ—¶ï¼Œè¯·æ³¨æ„ `package.json` ä¸­çš„ä¾èµ–å…³ç³»ã€‚UI å±‚ä¾èµ– Core å±‚ï¼Œåº”ç”¨å±‚ä¾èµ– UI å±‚ã€‚
3.  **ç±»å‹ç”Ÿæˆ**: é¦–æ¬¡è¿è¡Œæˆ–ä¿®æ”¹å…±äº«å±‚åï¼Œè‹¥é‡åˆ°ç±»å‹é”™è¯¯ï¼Œè¯·ç¡®ä¿åœ¨å­åº”ç”¨ä¸­è¿è¡Œäº† `pnpm postinstall` æˆ–å¯åŠ¨è¿‡ `pnpm dev` ä»¥ç”Ÿæˆ `.nuxt` ç±»å‹æ–‡ä»¶ã€‚
4.  **é…ç½®å†²çª**: å­åº”ç”¨çš„ `nuxt.config.ts` ä¼šè¦†ç›–ä¸Šå±‚ Layer ä¸­çš„åŒåé…ç½®ã€‚

## ğŸ¤ åä½œå»ºè®®

- **çº¯å‡½æ•°/ç±»å‹**: ä¼˜å…ˆæ”¾å…¥ `packages/utils`ã€‚
- **é€šç”¨ä¸šåŠ¡é€»è¾‘**: æ”¾å…¥ `packages/core`ã€‚
- **é€šç”¨ UI ç»„ä»¶**: æ”¾å…¥ `packages/ui`ã€‚
- **ç‰¹å®šä¸šåŠ¡**: ä»…åœ¨ `apps/` ä¸‹å¯¹åº”çš„åº”ç”¨ä¸­å®ç°ã€‚
