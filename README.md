# Monorepo Nuxt 4 é¡¹ç›®

è¿™æ˜¯ä¸€ä¸ªåŸºäº Nuxt 4 çš„é«˜åº¦å·¥ç¨‹åŒ–çš„ Monorepo é¡¹ç›®ï¼Œä½¿ç”¨ pnpm workspaces å’Œ Turborepo è¿›è¡Œç®¡ç†ã€‚é¡¹ç›®é‡‡ç”¨ **Nuxt Layers** æ¶æ„ï¼Œå®ç°äº†ä»£ç çš„é«˜åº¦å¤ç”¨å’Œåº”ç”¨é—´çš„è§£è€¦ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: [Nuxt 4](https://nuxt.com/)
- **åŒ…ç®¡ç†**: [pnpm](https://pnpm.io/)
- **ä»»åŠ¡ç®¡ç†**: [Turborepo](https://turbo.build/)
- **æ ·å¼**: [Tailwind CSS](https://tailwindcss.com/)
- **çŠ¶æ€ç®¡ç†**: [Pinia](https://pinia.vuejs.org/)
- **è¯­è¨€**: [TypeScript](https://www.typescriptlang.org/)

## ğŸ“ ç›®å½•è¯´æ˜

```text
.
â”œâ”€â”€ apps/                   # åº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ web/                # åº”ç”¨ 1 (Nuxt 4)
â”‚   â””â”€â”€ web1/               # åº”ç”¨ 2 (Nuxt 4)
â”œâ”€â”€ packages/               # å…±äº«åŒ…ç›®å½•
â”‚   â””â”€â”€ shared/             # æ ¸å¿ƒå…±äº«å±‚ (Nuxt Layer)
â”‚       â”œâ”€â”€ layouts/        # å…±äº«å¸ƒå±€
â”‚       â”œâ”€â”€ modules/        # å…±äº« Nuxt æ¨¡å—
â”‚       â”œâ”€â”€ plugins/        # å…±äº«æ’ä»¶
â”‚       â”œâ”€â”€ server/         # å…±äº«æœåŠ¡å™¨ä¸­é—´ä»¶/è·¯ç”±
â”‚       â”œâ”€â”€ stores/         # å…±äº« Pinia ä»“åº“
â”‚       â””â”€â”€ types/          # å…¨å±€ç±»å‹å®šä¹‰
â”œâ”€â”€ package.json            # æ ¹é¡¹ç›®é…ç½®
â”œâ”€â”€ pnpm-workspace.yaml     # pnpm å·¥ä½œåŒºé…ç½®
â”œâ”€â”€ turbo.json              # Turborepo ä»»åŠ¡æµé…ç½®
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¼€å‘èŒƒå¼ (Development Paradigm)

### 1. Nuxt Layers ç»§æ‰¿æœºåˆ¶
æœ¬é¡¹ç›®åˆ©ç”¨ Nuxt 4 çš„ `extends` ç‰¹æ€§ã€‚`packages/shared` ä½œä¸ºä¸€ä¸ªåŸºç¡€å±‚ï¼ŒåŒ…å«äº†æ‰€æœ‰åº”ç”¨é€šç”¨çš„é…ç½®ã€æ¨¡å—å’Œ UI é€»è¾‘ã€‚

- **åº”ç”¨å±‚ (`apps/*`)**: åªéœ€å…³æ³¨åº”ç”¨ç‰¹å®šçš„ä¸šåŠ¡é€»è¾‘ã€‚åœ¨ `nuxt.config.ts` ä¸­é€šè¿‡ `extends: ["../../packages/shared"]` ç»§æ‰¿å…±äº«å±‚ã€‚
- **å…±äº«å±‚ (`packages/shared`)**: å­˜æ”¾è·¨åº”ç”¨å…±äº«çš„ä»£ç ã€‚ä¿®æ”¹æ­¤å¤„çš„ä»£ç ä¼šè‡ªåŠ¨åº”ç”¨åˆ°æ‰€æœ‰ç»§æ‰¿å®ƒçš„åº”ç”¨ä¸­ã€‚
- **è‡ªåŠ¨æ¨¡å—æ³¨å…¥**: `packages/shared/modules/base.ts` ä¼šè‡ªåŠ¨ä¸ºæ‰€æœ‰åº”ç”¨æ³¨å…¥æ ¸å¿ƒä¾èµ–ï¼ˆPinia, Tailwind CSS, Element Plus, VueUseï¼‰ï¼Œå¼€å‘è€…æ— éœ€åœ¨å­åº”ç”¨ä¸­é‡å¤å®‰è£…ã€‚

### 2. ä»£ç å…±äº«ç­–ç•¥
- **å¸ƒå±€/ç»„ä»¶**: æ”¾åœ¨ `packages/shared/layouts` æˆ–ç»„ä»¶ç›®å½•ä¸­ï¼Œå­åº”ç”¨å¯ç›´æ¥ä½¿ç”¨æˆ–é‡å†™ã€‚
- **æ ·å¼å¼€å‘**: `packages/shared` ä¸­çš„ç»„ä»¶ç°åœ¨å®Œå…¨æ”¯æŒ Tailwind CSSã€‚åªéœ€æŒ‰å¸¸è§„æ–¹å¼ç¼–å†™ Tailwind ç±»åï¼Œæ‰€æœ‰å¼•ç”¨è¯¥ç»„ä»¶çš„åº”ç”¨åœ¨æ„å»ºæ—¶éƒ½ä¼šè‡ªåŠ¨æ‰«æå¹¶ç”Ÿæˆå¯¹åº”æ ·å¼ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚
- **çŠ¶æ€ç®¡ç†**: å…¬å…±çŠ¶æ€ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€æˆæƒï¼‰æ”¾åœ¨ `packages/shared/stores`ã€‚
- **ä¸­é—´ä»¶/æ’ä»¶**: é€šç”¨çš„æ‹¦æˆªé€»è¾‘å’Œæ’ä»¶æ”¾åœ¨ `packages/shared/server` æˆ– `plugins`ã€‚

### 3. å›½é™…åŒ– (i18n) ç­–ç•¥
- **é€šç”¨é…ç½®**: è·¯ç”±ç­–ç•¥ï¼ˆ`strategy`ï¼‰ã€é»˜è®¤è¯­è¨€ç­‰æ ¸å¿ƒé…ç½®ç»Ÿä¸€åœ¨ `packages/shared/i18n-config.ts` ä¸­ç®¡ç†ï¼Œä¿®æ”¹ä¸€å¤„å³å¯å½±å“æ‰€æœ‰åº”ç”¨ã€‚
- **è¯­è¨€åŒ…**: å„ä¸ªåº”ç”¨åªéœ€åœ¨ `nuxt.config.ts` ä¸­å®šä¹‰è‡ªå·±çš„ `locales` åˆ—è¡¨å’Œè¯­è¨€æ–‡ä»¶è·¯å¾„ã€‚
- **æ‰©å±•æ€§**: å¦‚æœåº”ç”¨éœ€è¦è¦†ç›–é€šç”¨ç­–ç•¥ï¼ˆä¾‹å¦‚æƒ³ç”¨ä¸åŒçš„è·¯ç”±æ¨¡å¼ï¼‰ï¼Œå¯ä»¥ç›´æ¥åœ¨åº”ç”¨çš„ `i18n` é…ç½®ä¸­é‡å†™ç›¸å…³å­—æ®µã€‚

### 4. åˆ«åçº¦å®š
- `@` æˆ– `~`: æŒ‡å‘**å½“å‰åº”ç”¨**çš„æ ¹ç›®å½•ã€‚
- `~~`: æŒ‡å‘æ•´ä¸ª **Monorepo** çš„æ ¹ç›®å½•ï¼Œæ–¹ä¾¿è·¨åŒ…å¼•ç”¨ã€‚

## âŒ¨ï¸ å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
| :--- | :--- |
| `pnpm install` | å®‰è£…æ‰€æœ‰ä¾èµ– |
| `pnpm dev` | å¯åŠ¨æ‰€æœ‰åº”ç”¨çš„å¼€å‘æœåŠ¡å™¨ |
| `pnpm build` | æ„å»ºæ‰€æœ‰åº”ç”¨ |
| `pnpm lint` | è¿è¡Œ lint æ£€æŸ¥ |

## âš ï¸ æ³¨æ„äº‹é¡¹

1.  **ä¾èµ–å®‰è£…**: è¯·åŠ¡å¿…åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œ `pnpm install`ã€‚è‹¥éœ€ç»™ç‰¹å®šåº”ç”¨å®‰è£…ä¾èµ–ï¼Œå»ºè®®è¿›å…¥è¯¥ç›®å½•æ‰§è¡Œæˆ–ä½¿ç”¨ `pnpm add <pkg> --filter <app-name>`ã€‚
2.  **Shared åŒ…å¼€å‘**: ä¿®æ”¹ `packages/shared` æ—¶ï¼Œè¯·æ³¨æ„ `package.json` ä¸­çš„ `peerDependencies`ã€‚Shared åŒ…ä½œä¸º Nuxt Layerï¼Œåº”å£°æ˜å¯¹ `vue` å’Œ `nuxt` çš„å¯¹ç­‰ä¾èµ–ï¼Œä»¥ç¡®ä¿ä¸å®¿ä¸»åº”ç”¨ç‰ˆæœ¬å…¼å®¹ã€‚
3.  **ç±»å‹ç”Ÿæˆ**: é¦–æ¬¡è¿è¡Œæˆ–ä¿®æ”¹å…±äº«å±‚åï¼Œè‹¥é‡åˆ°ç±»å‹é”™è¯¯ï¼Œè¯·ç¡®ä¿åœ¨å­åº”ç”¨ä¸­è¿è¡Œäº† `pnpm postinstall` æˆ–å¯åŠ¨è¿‡ `pnpm dev` ä»¥ç”Ÿæˆ `.nuxt` ç±»å‹æ–‡ä»¶ã€‚
3.  **é…ç½®å†²çª**: å­åº”ç”¨çš„ `nuxt.config.ts` ä¼šè¦†ç›– `packages/shared` ä¸­çš„åŒåé…ç½®ã€‚å¦‚æœæŸä¸ªé…ç½®ä¸ç”Ÿæ•ˆï¼Œè¯·æ£€æŸ¥æ˜¯å¦å­˜åœ¨å†²çªã€‚
4.  **ç¯å¢ƒéš”ç¦»**: è™½ç„¶æ˜¯ Monorepoï¼Œä½†æ¯ä¸ªåº”ç”¨åœ¨ `apps/` ä¸‹åº”ä¿æŒç›¸å¯¹ç‹¬ç«‹çš„ `env` é…ç½®ï¼Œé¿å…ç¯å¢ƒæ±¡æŸ“ã€‚

## ğŸ¤ åä½œå»ºè®®

- æ–°å¢é€šç”¨åŠŸèƒ½æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘åœ¨ `packages/shared` ä¸­å®ç°ã€‚
- ä¿æŒ `packages/shared` çš„çº¯ç²¹æ€§ï¼Œé¿å…å¼•å…¥ä»…é’ˆå¯¹å•ä¸€åº”ç”¨çš„ç‰¹æ®Šé€»è¾‘ã€‚
- åœ¨ä¿®æ”¹å…±äº«åŒ…åï¼Œå»ºè®®ä½¿ç”¨ `pnpm lint` ç¡®ä¿ä¸ä¼šç ´åå…¶ä»–åº”ç”¨çš„æ„å»ºã€‚
